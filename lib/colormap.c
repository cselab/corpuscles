#include <stdio.h>
#include <stdlib.h>
#include "real.h"

#include "co/colormap.h"
#include "co/err.h"
#include "co/macro.h"
#include "co/util.h"

static real Palura[][3] = {
    { 0.2081, 0.1663, 0.5292 },
    { 0.2091, 0.1721, 0.5411 },
    { 0.2101, 0.1779, 0.5530 },
    { 0.2109, 0.1837, 0.5650 },
    { 0.2116, 0.1895, 0.5771 },
    { 0.2121, 0.1954, 0.5892 },
    { 0.2124, 0.2013, 0.6013 },
    { 0.2125, 0.2072, 0.6135 },
    { 0.2123, 0.2132, 0.6258 },
    { 0.2118, 0.2192, 0.6381 },
    { 0.2111, 0.2253, 0.6505 },
    { 0.2099, 0.2315, 0.6629 },
    { 0.2084, 0.2377, 0.6753 },
    { 0.2063, 0.2440, 0.6878 },
    { 0.2038, 0.2503, 0.7003 },
    { 0.2006, 0.2568, 0.7129 },
    { 0.1968, 0.2632, 0.7255 },
    { 0.1921, 0.2698, 0.7381 },
    { 0.1867, 0.2764, 0.7507 },
    { 0.1802, 0.2832, 0.7634 },
    { 0.1728, 0.2902, 0.7762 },
    { 0.1641, 0.2975, 0.7890 },
    { 0.1541, 0.3052, 0.8017 },
    { 0.1427, 0.3132, 0.8145 },
    { 0.1295, 0.3217, 0.8269 },
    { 0.1147, 0.3306, 0.8387 },
    { 0.0986, 0.3397, 0.8495 },
    { 0.0816, 0.3486, 0.8588 },
    { 0.0646, 0.3572, 0.8664 },
    { 0.0482, 0.3651, 0.8722 },
    { 0.0329, 0.3724, 0.8765 },
    { 0.0213, 0.3792, 0.8796 },
    { 0.0136, 0.3853, 0.8815 },
    { 0.0086, 0.3911, 0.8827 },
    { 0.0060, 0.3965, 0.8833 },
    { 0.0051, 0.4017, 0.8834 },
    { 0.0054, 0.4066, 0.8831 },
    { 0.0067, 0.4113, 0.8825 },
    { 0.0089, 0.4159, 0.8816 },
    { 0.0116, 0.4203, 0.8805 },
    { 0.0148, 0.4246, 0.8793 },
    { 0.0184, 0.4288, 0.8779 },
    { 0.0223, 0.4329, 0.8763 },
    { 0.0264, 0.4370, 0.8747 },
    { 0.0306, 0.4410, 0.8729 },
    { 0.0349, 0.4449, 0.8711 },
    { 0.0394, 0.4488, 0.8692 },
    { 0.0437, 0.4526, 0.8672 },
    { 0.0477, 0.4564, 0.8652 },
    { 0.0514, 0.4602, 0.8632 },
    { 0.0549, 0.4640, 0.8611 },
    { 0.0582, 0.4677, 0.8589 },
    { 0.0612, 0.4714, 0.8568 },
    { 0.0640, 0.4751, 0.8546 },
    { 0.0666, 0.4788, 0.8525 },
    { 0.0689, 0.4825, 0.8503 },
    { 0.0710, 0.4862, 0.8481 },
    { 0.0729, 0.4899, 0.8460 },
    { 0.0746, 0.4937, 0.8439 },
    { 0.0761, 0.4974, 0.8418 },
    { 0.0773, 0.5012, 0.8398 },
    { 0.0782, 0.5051, 0.8378 },
    { 0.0789, 0.5089, 0.8359 },
    { 0.0794, 0.5129, 0.8341 },
    { 0.0795, 0.5169, 0.8324 },
    { 0.0793, 0.5210, 0.8308 },
    { 0.0788, 0.5251, 0.8293 },
    { 0.0778, 0.5295, 0.8280 },
    { 0.0764, 0.5339, 0.8270 },
    { 0.0746, 0.5384, 0.8261 },
    { 0.0724, 0.5431, 0.8253 },
    { 0.0698, 0.5479, 0.8247 },
    { 0.0668, 0.5527, 0.8243 },
    { 0.0636, 0.5577, 0.8239 },
    { 0.0600, 0.5627, 0.8237 },
    { 0.0562, 0.5677, 0.8234 },
    { 0.0523, 0.5727, 0.8231 },
    { 0.0484, 0.5777, 0.8228 },
    { 0.0445, 0.5826, 0.8223 },
    { 0.0408, 0.5874, 0.8217 },
    { 0.0372, 0.5922, 0.8209 },
    { 0.0342, 0.5968, 0.8198 },
    { 0.0317, 0.6012, 0.8186 },
    { 0.0296, 0.6055, 0.8171 },
    { 0.0279, 0.6097, 0.8154 },
    { 0.0265, 0.6137, 0.8135 },
    { 0.0255, 0.6176, 0.8114 },
    { 0.0248, 0.6214, 0.8091 },
    { 0.0243, 0.6250, 0.8066 },
    { 0.0239, 0.6285, 0.8039 },
    { 0.0237, 0.6319, 0.8010 },
    { 0.0235, 0.6352, 0.7980 },
    { 0.0233, 0.6384, 0.7948 },
    { 0.0231, 0.6415, 0.7916 },
    { 0.0230, 0.6445, 0.7881 },
    { 0.0229, 0.6474, 0.7846 },
    { 0.0227, 0.6503, 0.7810 },
    { 0.0227, 0.6531, 0.7773 },
    { 0.0232, 0.6558, 0.7735 },
    { 0.0238, 0.6585, 0.7696 },
    { 0.0246, 0.6611, 0.7656 },
    { 0.0263, 0.6637, 0.7615 },
    { 0.0282, 0.6663, 0.7574 },
    { 0.0306, 0.6688, 0.7532 },
    { 0.0338, 0.6712, 0.7490 },
    { 0.0373, 0.6737, 0.7446 },
    { 0.0418, 0.6761, 0.7402 },
    { 0.0467, 0.6784, 0.7358 },
    { 0.0516, 0.6808, 0.7313 },
    { 0.0574, 0.6831, 0.7267 },
    { 0.0629, 0.6854, 0.7221 },
    { 0.0692, 0.6877, 0.7173 },
    { 0.0755, 0.6899, 0.7126 },
    { 0.0820, 0.6921, 0.7078 },
    { 0.0889, 0.6943, 0.7029 },
    { 0.0956, 0.6965, 0.6979 },
    { 0.1031, 0.6986, 0.6929 },
    { 0.1104, 0.7007, 0.6878 },
    { 0.1180, 0.7028, 0.6827 },
    { 0.1258, 0.7049, 0.6775 },
    { 0.1335, 0.7069, 0.6723 },
    { 0.1418, 0.7089, 0.6669 },
    { 0.1499, 0.7109, 0.6616 },
    { 0.1585, 0.7129, 0.6561 },
    { 0.1671, 0.7148, 0.6507 },
    { 0.1758, 0.7168, 0.6451 },
    { 0.1849, 0.7186, 0.6395 },
    { 0.1938, 0.7205, 0.6338 },
    { 0.2033, 0.7223, 0.6281 },
    { 0.2128, 0.7241, 0.6223 },
    { 0.2224, 0.7259, 0.6165 },
    { 0.2324, 0.7275, 0.6107 },
    { 0.2423, 0.7292, 0.6048 },
    { 0.2527, 0.7308, 0.5988 },
    { 0.2631, 0.7324, 0.5929 },
    { 0.2735, 0.7339, 0.5869 },
    { 0.2845, 0.7354, 0.5809 },
    { 0.2953, 0.7368, 0.5749 },
    { 0.3064, 0.7381, 0.5689 },
    { 0.3177, 0.7394, 0.5630 },
    { 0.3289, 0.7406, 0.5570 },
    { 0.3405, 0.7417, 0.5512 },
    { 0.3520, 0.7428, 0.5453 },
    { 0.3635, 0.7438, 0.5396 },
    { 0.3753, 0.7446, 0.5339 },
    { 0.3869, 0.7454, 0.5283 },
    { 0.3986, 0.7461, 0.5229 },
    { 0.4103, 0.7467, 0.5175 },
    { 0.4218, 0.7473, 0.5123 },
    { 0.4334, 0.7477, 0.5072 },
    { 0.4447, 0.7482, 0.5021 },
    { 0.4561, 0.7485, 0.4972 },
    { 0.4672, 0.7487, 0.4924 },
    { 0.4783, 0.7489, 0.4877 },
    { 0.4892, 0.7491, 0.4831 },
    { 0.5000, 0.7491, 0.4786 },
    { 0.5106, 0.7492, 0.4741 },
    { 0.5212, 0.7492, 0.4698 },
    { 0.5315, 0.7491, 0.4655 },
    { 0.5418, 0.7490, 0.4613 },
    { 0.5519, 0.7489, 0.4571 },
    { 0.5619, 0.7487, 0.4531 },
    { 0.5718, 0.7485, 0.4490 },
    { 0.5816, 0.7482, 0.4451 },
    { 0.5913, 0.7479, 0.4412 },
    { 0.6009, 0.7476, 0.4374 },
    { 0.6103, 0.7473, 0.4335 },
    { 0.6197, 0.7469, 0.4298 },
    { 0.6290, 0.7465, 0.4261 },
    { 0.6382, 0.7460, 0.4224 },
    { 0.6473, 0.7456, 0.4188 },
    { 0.6564, 0.7451, 0.4152 },
    { 0.6653, 0.7446, 0.4116 },
    { 0.6742, 0.7441, 0.4081 },
    { 0.6830, 0.7435, 0.4046 },
    { 0.6918, 0.7430, 0.4011 },
    { 0.7004, 0.7424, 0.3976 },
    { 0.7091, 0.7418, 0.3942 },
    { 0.7176, 0.7412, 0.3908 },
    { 0.7261, 0.7405, 0.3874 },
    { 0.7346, 0.7399, 0.3840 },
    { 0.7430, 0.7392, 0.3806 },
    { 0.7513, 0.7385, 0.3773 },
    { 0.7596, 0.7378, 0.3739 },
    { 0.7679, 0.7372, 0.3706 },
    { 0.7761, 0.7364, 0.3673 },
    { 0.7843, 0.7357, 0.3639 },
    { 0.7924, 0.7350, 0.3606 },
    { 0.8005, 0.7343, 0.3573 },
    { 0.8085, 0.7336, 0.3539 },
    { 0.8166, 0.7329, 0.3506 },
    { 0.8246, 0.7322, 0.3472 },
    { 0.8325, 0.7315, 0.3438 },
    { 0.8405, 0.7308, 0.3404 },
    { 0.8484, 0.7301, 0.3370 },
    { 0.8563, 0.7294, 0.3336 },
    { 0.8642, 0.7288, 0.3300 },
    { 0.8720, 0.7282, 0.3265 },
    { 0.8798, 0.7276, 0.3229 },
    { 0.8877, 0.7271, 0.3193 },
    { 0.8954, 0.7266, 0.3156 },
    { 0.9032, 0.7262, 0.3117 },
    { 0.9110, 0.7259, 0.3078 },
    { 0.9187, 0.7256, 0.3038 },
    { 0.9264, 0.7256, 0.2996 },
    { 0.9341, 0.7256, 0.2953 },
    { 0.9417, 0.7259, 0.2907 },
    { 0.9493, 0.7264, 0.2859 },
    { 0.9567, 0.7273, 0.2808 },
    { 0.9639, 0.7285, 0.2754 },
    { 0.9708, 0.7303, 0.2696 },
    { 0.9773, 0.7326, 0.2634 },
    { 0.9831, 0.7355, 0.2570 },
    { 0.9882, 0.7390, 0.2504 },
    { 0.9922, 0.7431, 0.2437 },
    { 0.9952, 0.7476, 0.2373 },
    { 0.9973, 0.7524, 0.2310 },
    { 0.9986, 0.7573, 0.2251 },
    { 0.9991, 0.7624, 0.2195 },
    { 0.9990, 0.7675, 0.2141 },
    { 0.9985, 0.7726, 0.2090 },
    { 0.9976, 0.7778, 0.2042 },
    { 0.9964, 0.7829, 0.1995 },
    { 0.9950, 0.7880, 0.1949 },
    { 0.9933, 0.7931, 0.1905 },
    { 0.9914, 0.7981, 0.1863 },
    { 0.9894, 0.8032, 0.1821 },
    { 0.9873, 0.8083, 0.1780 },
    { 0.9851, 0.8133, 0.1740 },
    { 0.9828, 0.8184, 0.1700 },
    { 0.9805, 0.8235, 0.1661 },
    { 0.9782, 0.8286, 0.1622 },
    { 0.9759, 0.8337, 0.1583 },
    { 0.9736, 0.8389, 0.1544 },
    { 0.9713, 0.8441, 0.1505 },
    { 0.9692, 0.8494, 0.1465 },
    { 0.9672, 0.8548, 0.1425 },
    { 0.9654, 0.8603, 0.1385 },
    { 0.9638, 0.8659, 0.1343 },
    { 0.9623, 0.8716, 0.1301 },
    { 0.9611, 0.8774, 0.1258 },
    { 0.9600, 0.8834, 0.1215 },
    { 0.9593, 0.8895, 0.1171 },
    { 0.9588, 0.8958, 0.1126 },
    { 0.9586, 0.9022, 0.1082 },
    { 0.9587, 0.9088, 0.1036 },
    { 0.9591, 0.9155, 0.0990 },
    { 0.9599, 0.9225, 0.0944 },
    { 0.9610, 0.9296, 0.0897 },
    { 0.9624, 0.9368, 0.0850 },
    { 0.9641, 0.9443, 0.0802 },
    { 0.9662, 0.9518, 0.0753 },
    { 0.9685, 0.9595, 0.0703 },
    { 0.9710, 0.9673, 0.0651 },
    { 0.9736, 0.9752, 0.0597 },
    { 0.9763, 0.9831, 0.0538 },
};

static real Viridis[][3] = {
    { 0.26700401, 0.00487433, 0.32941519 },
    { 0.26851048, 0.00960483, 0.33542652 },
    { 0.26994384, 0.01462494, 0.34137895 },
    { 0.27130489, 0.01994186, 0.34726862 },
    { 0.27259384, 0.02556309, 0.35309303 },
    { 0.27380934, 0.03149748, 0.35885256 },
    { 0.27495242, 0.03775181, 0.36454323 },
    { 0.27602238, 0.04416723, 0.37016418 },
    { 0.2770184, 0.05034437, 0.37571452 },
    { 0.27794143, 0.05632444, 0.38119074 },
    { 0.27879067, 0.06214536, 0.38659204 },
    { 0.2795655, 0.06783587, 0.39191723 },
    { 0.28026658, 0.07341724, 0.39716349 },
    { 0.28089358, 0.07890703, 0.40232944 },
    { 0.28144581, 0.0843197, 0.40741404 },
    { 0.28192358, 0.08966622, 0.41241521 },
    { 0.28232739, 0.09495545, 0.41733086 },
    { 0.28265633, 0.10019576, 0.42216032 },
    { 0.28291049, 0.10539345, 0.42690202 },
    { 0.28309095, 0.11055307, 0.43155375 },
    { 0.28319704, 0.11567966, 0.43611482 },
    { 0.28322882, 0.12077701, 0.44058404 },
    { 0.28318684, 0.12584799, 0.44496 },
    { 0.283072, 0.13089477, 0.44924127 },
    { 0.28288389, 0.13592005, 0.45342734 },
    { 0.28262297, 0.14092556, 0.45751726 },
    { 0.28229037, 0.14591233, 0.46150995 },
    { 0.28188676, 0.15088147, 0.46540474 },
    { 0.28141228, 0.15583425, 0.46920128 },
    { 0.28086773, 0.16077132, 0.47289909 },
    { 0.28025468, 0.16569272, 0.47649762 },
    { 0.27957399, 0.17059884, 0.47999675 },
    { 0.27882618, 0.1754902, 0.48339654 },
    { 0.27801236, 0.18036684, 0.48669702 },
    { 0.27713437, 0.18522836, 0.48989831 },
    { 0.27619376, 0.19007447, 0.49300074 },
    { 0.27519116, 0.1949054, 0.49600488 },
    { 0.27412802, 0.19972086, 0.49891131 },
    { 0.27300596, 0.20452049, 0.50172076 },
    { 0.27182812, 0.20930306, 0.50443413 },
    { 0.27059473, 0.21406899, 0.50705243 },
    { 0.26930756, 0.21881782, 0.50957678 },
    { 0.26796846, 0.22354911, 0.5120084 },
    { 0.26657984, 0.2282621, 0.5143487 },
    { 0.2651445, 0.23295593, 0.5165993 },
    { 0.2636632, 0.23763078, 0.51876163 },
    { 0.26213801, 0.24228619, 0.52083736 },
    { 0.26057103, 0.2469217, 0.52282822 },
    { 0.25896451, 0.25153685, 0.52473609 },
    { 0.25732244, 0.2561304, 0.52656332 },
    { 0.25564519, 0.26070284, 0.52831152 },
    { 0.25393498, 0.26525384, 0.52998273 },
    { 0.25219404, 0.26978306, 0.53157905 },
    { 0.25042462, 0.27429024, 0.53310261 },
    { 0.24862899, 0.27877509, 0.53455561 },
    { 0.2468114, 0.28323662, 0.53594093 },
    { 0.24497208, 0.28767547, 0.53726018 },
    { 0.24311324, 0.29209154, 0.53851561 },
    { 0.24123708, 0.29648471, 0.53970946 },
    { 0.23934575, 0.30085494, 0.54084398 },
    { 0.23744138, 0.30520222, 0.5419214 },
    { 0.23552606, 0.30952657, 0.54294396 },
    { 0.23360277, 0.31382773, 0.54391424 },
    { 0.2316735, 0.3181058, 0.54483444 },
    { 0.22973926, 0.32236127, 0.54570633 },
    { 0.22780192, 0.32659432, 0.546532 },
    { 0.2258633, 0.33080515, 0.54731353 },
    { 0.22392515, 0.334994, 0.54805291 },
    { 0.22198915, 0.33916114, 0.54875211 },
    { 0.22005691, 0.34330688, 0.54941304 },
    { 0.21812995, 0.34743154, 0.55003755 },
    { 0.21620971, 0.35153548, 0.55062743 },
    { 0.21429757, 0.35561907, 0.5511844 },
    { 0.21239477, 0.35968273, 0.55171011 },
    { 0.2105031, 0.36372671, 0.55220646 },
    { 0.20862342, 0.36775151, 0.55267486 },
    { 0.20675628, 0.37175775, 0.55311653 },
    { 0.20490257, 0.37574589, 0.55353282 },
    { 0.20306309, 0.37971644, 0.55392505 },
    { 0.20123854, 0.38366989, 0.55429441 },
    { 0.1994295, 0.38760678, 0.55464205 },
    { 0.1976365, 0.39152762, 0.55496905 },
    { 0.19585993, 0.39543297, 0.55527637 },
    { 0.19410009, 0.39932336, 0.55556494 },
    { 0.19235719, 0.40319934, 0.55583559 },
    { 0.19063135, 0.40706148, 0.55608907 },
    { 0.18892259, 0.41091033, 0.55632606 },
    { 0.18723083, 0.41474645, 0.55654717 },
    { 0.18555593, 0.4185704, 0.55675292 },
    { 0.18389763, 0.42238275, 0.55694377 },
    { 0.18225561, 0.42618405, 0.5571201 },
    { 0.18062949, 0.42997486, 0.55728221 },
    { 0.17901879, 0.43375572, 0.55743035 },
    { 0.17742298, 0.4375272, 0.55756466 },
    { 0.17584148, 0.44128981, 0.55768526 },
    { 0.17427363, 0.4450441, 0.55779216 },
    { 0.17271876, 0.4487906, 0.55788532 },
    { 0.17117615, 0.4525298, 0.55796464 },
    { 0.16964573, 0.45626209, 0.55803034 },
    { 0.16812641, 0.45998802, 0.55808199 },
    { 0.1666171, 0.46370813, 0.55811913 },
    { 0.16511703, 0.4674229, 0.55814141 },
    { 0.16362543, 0.47113278, 0.55814842 },
    { 0.16214155, 0.47483821, 0.55813967 },
    { 0.16066467, 0.47853961, 0.55811466 },
    { 0.15919413, 0.4822374, 0.5580728 },
    { 0.15772933, 0.48593197, 0.55801347 },
    { 0.15626973, 0.4896237, 0.557936 },
    { 0.15481488, 0.49331293, 0.55783967 },
    { 0.15336445, 0.49700003, 0.55772371 },
    { 0.1519182, 0.50068529, 0.55758733 },
    { 0.15047605, 0.50436904, 0.55742968 },
    { 0.14903918, 0.50805136, 0.5572505 },
    { 0.14760731, 0.51173263, 0.55704861 },
    { 0.14618026, 0.51541316, 0.55682271 },
    { 0.14475863, 0.51909319, 0.55657181 },
    { 0.14334327, 0.52277292, 0.55629491 },
    { 0.14193527, 0.52645254, 0.55599097 },
    { 0.14053599, 0.53013219, 0.55565893 },
    { 0.13914708, 0.53381201, 0.55529773 },
    { 0.13777048, 0.53749213, 0.55490625 },
    { 0.1364085, 0.54117264, 0.55448339 },
    { 0.13506561, 0.54485335, 0.55402906 },
    { 0.13374299, 0.54853458, 0.55354108 },
    { 0.13244401, 0.55221637, 0.55301828 },
    { 0.13117249, 0.55589872, 0.55245948 },
    { 0.1299327, 0.55958162, 0.55186354 },
    { 0.12872938, 0.56326503, 0.55122927 },
    { 0.12756771, 0.56694891, 0.55055551 },
    { 0.12645338, 0.57063316, 0.5498411 },
    { 0.12539383, 0.57431754, 0.54908564 },
    { 0.12439474, 0.57800205, 0.5482874 },
    { 0.12346281, 0.58168661, 0.54744498 },
    { 0.12260562, 0.58537105, 0.54655722 },
    { 0.12183122, 0.58905521, 0.54562298 },
    { 0.12114807, 0.59273889, 0.54464114 },
    { 0.12056501, 0.59642187, 0.54361058 },
    { 0.12009154, 0.60010387, 0.54253043 },
    { 0.11973756, 0.60378459, 0.54139999 },
    { 0.11951163, 0.60746388, 0.54021751 },
    { 0.11942341, 0.61114146, 0.53898192 },
    { 0.11948255, 0.61481702, 0.53769219 },
    { 0.11969858, 0.61849025, 0.53634733 },
    { 0.12008079, 0.62216081, 0.53494633 },
    { 0.12063824, 0.62582833, 0.53348834 },
    { 0.12137972, 0.62949242, 0.53197275 },
    { 0.12231244, 0.63315277, 0.53039808 },
    { 0.12344358, 0.63680899, 0.52876343 },
    { 0.12477953, 0.64046069, 0.52706792 },
    { 0.12632581, 0.64410744, 0.52531069 },
    { 0.12808703, 0.64774881, 0.52349092 },
    { 0.13006688, 0.65138436, 0.52160791 },
    { 0.13226797, 0.65501363, 0.51966086 },
    { 0.13469183, 0.65863619, 0.5176488 },
    { 0.13733921, 0.66225157, 0.51557101 },
    { 0.14020991, 0.66585927, 0.5134268 },
    { 0.14330291, 0.66945881, 0.51121549 },
    { 0.1466164, 0.67304968, 0.50893644 },
    { 0.15014782, 0.67663139, 0.5065889 },
    { 0.15389405, 0.68020343, 0.50417217 },
    { 0.15785146, 0.68376525, 0.50168574 },
    { 0.16201598, 0.68731632, 0.49912906 },
    { 0.1663832, 0.69085611, 0.49650163 },
    { 0.1709484, 0.69438405, 0.49380294 },
    { 0.17570671, 0.6978996, 0.49103252 },
    { 0.18065314, 0.70140222, 0.48818938 },
    { 0.18578266, 0.70489133, 0.48527326 },
    { 0.19109018, 0.70836635, 0.48228395 },
    { 0.19657063, 0.71182668, 0.47922108 },
    { 0.20221902, 0.71527175, 0.47608431 },
    { 0.20803045, 0.71870095, 0.4728733 },
    { 0.21400015, 0.72211371, 0.46958774 },
    { 0.22012381, 0.72550945, 0.46622638 },
    { 0.2263969, 0.72888753, 0.46278934 },
    { 0.23281498, 0.73224735, 0.45927675 },
    { 0.2393739, 0.73558828, 0.45568838 },
    { 0.24606968, 0.73890972, 0.45202405 },
    { 0.25289851, 0.74221104, 0.44828355 },
    { 0.25985676, 0.74549162, 0.44446673 },
    { 0.26694127, 0.74875084, 0.44057284 },
    { 0.27414922, 0.75198807, 0.4366009 },
    { 0.28147681, 0.75520266, 0.43255207 },
    { 0.28892102, 0.75839399, 0.42842626 },
    { 0.29647899, 0.76156142, 0.42422341 },
    { 0.30414796, 0.76470433, 0.41994346 },
    { 0.31192534, 0.76782207, 0.41558638 },
    { 0.3198086, 0.77091403, 0.41115215 },
    { 0.3277958, 0.77397953, 0.40664011 },
    { 0.33588539, 0.7770179, 0.40204917 },
    { 0.34407411, 0.78002855, 0.39738103 },
    { 0.35235985, 0.78301086, 0.39263579 },
    { 0.36074053, 0.78596419, 0.38781353 },
    { 0.3692142, 0.78888793, 0.38291438 },
    { 0.37777892, 0.79178146, 0.3779385 },
    { 0.38643282, 0.79464415, 0.37288606 },
    { 0.39517408, 0.79747541, 0.36775726 },
    { 0.40400101, 0.80027461, 0.36255223 },
    { 0.4129135, 0.80304099, 0.35726893 },
    { 0.42190813, 0.80577412, 0.35191009 },
    { 0.43098317, 0.80847343, 0.34647607 },
    { 0.44013691, 0.81113836, 0.3409673 },
    { 0.44936763, 0.81376835, 0.33538426 },
    { 0.45867362, 0.81636288, 0.32972749 },
    { 0.46805314, 0.81892143, 0.32399761 },
    { 0.47750446, 0.82144351, 0.31819529 },
    { 0.4870258, 0.82392862, 0.31232133 },
    { 0.49661536, 0.82637633, 0.30637661 },
    { 0.5062713, 0.82878621, 0.30036211 },
    { 0.51599182, 0.83115784, 0.29427888 },
    { 0.52577622, 0.83349064, 0.2881265 },
    { 0.5356211, 0.83578452, 0.28190832 },
    { 0.5455244, 0.83803918, 0.27562602 },
    { 0.55548397, 0.84025437, 0.26928147 },
    { 0.5654976, 0.8424299, 0.26287683 },
    { 0.57556297, 0.84456561, 0.25641457 },
    { 0.58567772, 0.84666139, 0.24989748 },
    { 0.59583934, 0.84871722, 0.24332878 },
    { 0.60604528, 0.8507331, 0.23671214 },
    { 0.61629283, 0.85270912, 0.23005179 },
    { 0.62657923, 0.85464543, 0.22335258 },
    { 0.63690157, 0.85654226, 0.21662012 },
    { 0.64725685, 0.85839991, 0.20986086 },
    { 0.65764197, 0.86021878, 0.20308229 },
    { 0.66805369, 0.86199932, 0.19629307 },
    { 0.67848868, 0.86374211, 0.18950326 },
    { 0.68894351, 0.86544779, 0.18272455 },
    { 0.69941463, 0.86711711, 0.17597055 },
    { 0.70989842, 0.86875092, 0.16925712 },
    { 0.72039115, 0.87035015, 0.16260273 },
    { 0.73088902, 0.87191584, 0.15602894 },
    { 0.74138803, 0.87344918, 0.14956101 },
    { 0.75188414, 0.87495143, 0.14322828 },
    { 0.76237342, 0.87642392, 0.13706449 },
    { 0.77285183, 0.87786808, 0.13110864 },
    { 0.78331535, 0.87928545, 0.12540538 },
    { 0.79375994, 0.88067763, 0.12000532 },
    { 0.80418159, 0.88204632, 0.11496505 },
    { 0.81457634, 0.88339329, 0.11034678 },
    { 0.82494028, 0.88472036, 0.10621724 },
    { 0.83526959, 0.88602943, 0.1026459 },
    { 0.84556056, 0.88732243, 0.09970219 },
    { 0.8558096, 0.88860134, 0.09745186 },
    { 0.86601325, 0.88986815, 0.09595277 },
    { 0.87616824, 0.89112487, 0.09525046 },
    { 0.88627146, 0.89237353, 0.09537439 },
    { 0.89632002, 0.89361614, 0.09633538 },
    { 0.90631121, 0.89485467, 0.09812496 },
    { 0.91624212, 0.89609127, 0.1007168 },
    { 0.92610579, 0.89732977, 0.10407067 },
    { 0.93590444, 0.8985704, 0.10813094 },
    { 0.94563626, 0.899815, 0.11283773 },
    { 0.95529972, 0.90106534, 0.11812832 },
    { 0.96489353, 0.90232311, 0.12394051 },
    { 0.97441665, 0.90358991, 0.13021494 },
    { 0.98386829, 0.90486726, 0.13689671 },
    { 0.99324789, 0.90615657, 0.1439362 },
};

typedef int (*MType)(real, real, real, /**/ float *, float *, float *);
typedef int (*const CType)(real, real, real, /**/ float *, float *,
                           float *);

#define DEC(fun) \
    static int fun(real v, real l, real h, float *pR, float *pG, float *pB);
DEC(autumn);
DEC(cool);
DEC(copper);
DEC(gray);
DEC(jet);
DEC(palura);
DEC(spring);
DEC(summer);
DEC(viridis);
DEC(white);
DEC(winter);
static const CType Maps[] = {
    autumn,
    cool,
    copper,
    gray,
    jet,
    palura,
    spring,
    summer,
    viridis,
    white,
    winter,
};

static const char *Names[] = {
    "autumn",
    "cool",
    "copper",
    "gray",
    "jet",
    "palura",
    "spring",
    "summer",
    "viridis",
    "white",
    "winter",
};

int
colormap(real v, real l, real h, float *r, float *g, float *b)
{
    static MType map = NULL;
    const char *name;
    int i;
    int n;

    if (map == NULL) {
        name = getenv("COLORMAP");
        if (name == NULL)
            map = jet;
        else {
	    n = sizeof(Names) / sizeof(*Names);
            for (i = 0;; i++) {
                if (i == n) {
                    MSG("unknown colormap '%s'", name);
		    MSG("possible values:");
		    for (i = 0; i < n; i++)
			MSG("%s", Names[i]);
		    ERR(CO_INDEX, "");
		}
                if (util_eq(name, Names[i])) {
                    map = Maps[i];
                    break;
                }
            }
	}
    }
    return map(v, l, h, r, g, b);;
}

static int
jet(real v, real l, real h, float *pR, float *pG, float *pB)
{
    float R, G, B;

    if (v < l)
        v = l;
    if (v > h)
        v = h;

    if (l != h)
        v = 4 * (v - l) / (h - l);
    else
        v = 0;

    R = 0;
    G = B = 1;
    if (v < 1)
        G = v;
    else if (v < 2)
        B = 2 - v;
    else if (v < 3) {
        R = v - 2;
        B = 0;
    } else {
        R = 1;
        G = 4 - v;
        B = 0;
    }

    *pR = R;
    *pG = G;
    *pB = B;
    return CO_OK;
}

static int
viridis(real v, real l, real h, float *pR, float *pG, float *pB)
{
    int i;
    int j;
    int n;
    real al;
    real be;

    n = sizeof(Viridis) / sizeof(*Viridis);
    if (v < l)
        v = l;
    if (v > h)
        v = h;
    if (l != h)
        v = (n - 1) * (v - l) / (h - l);
    else
        v = 0;
    i = (int) v;
    if (i < 0)
        i = 0;
    j = i + 1;
    if (j > n - 1)
        j = n - 1;
    al = v - i;
    be = j - v;
    *pR = al * Viridis[i][0] + be * Viridis[j][0];
    *pG = al * Viridis[i][1] + be * Viridis[j][1];
    *pB = al * Viridis[i][2] + be * Viridis[j][2];
    return CO_OK;
}

static int
gray(real v, real l, real h, float *pR, float *pG, float *pB)
{
    if (v < l)
        v = l;
    if (v > h)
        v = h;
    if (l != h)
        v = (v - l) / (h - l);
    else
        v = 0;
    *pR = v;
    *pG = v;
    *pB = v;
    return CO_OK;
}

static int
cool(real v, real l, real h, float *pR, float *pG, float *pB)
{
    if (v < l)
        v = l;
    if (v > h)
        v = h;
    if (l != h)
        v = (v - l) / (h - l);
    else
        v = 0;
    *pR = v;
    *pG = 1 - v;
    *pB = 1;
    return CO_OK;
}

static int
winter(real v, real l, real h, float *pR, float *pG, float *pB)
{
    if (v < l)
        v = l;
    if (v > h)
        v = h;
    if (l != h)
        v = (v - l) / (h - l);
    else
        v = 0;
    *pR = 0;
    *pG = v;
    *pB = 1 - v / 2;
    return CO_OK;
}

static int
autumn(real v, real l, real h, float *pR, float *pG, float *pB)
{
    if (v < l)
        v = l;
    if (v > h)
        v = h;
    if (l != h)
        v = (v - l) / (h - l);
    else
        v = 0;
    *pR = 1;
    *pG = v;
    *pB = 0;
    return CO_OK;
}

static int
summer(real v, real l, real h, float *pR, float *pG, float *pB)
{
    if (v < l)
        v = l;
    if (v > h)
        v = h;
    if (l != h)
        v = (v - l) / (h - l);
    else
        v = 0;
    *pR = v;
    *pG = 0.5 + v / 2;
    *pB = 0.4;
    return CO_OK;
}

static int
copper(real v, real l, real h, float *pR, float *pG, float *pB)
{
    if (v < l)
        v = l;
    if (v > h)
        v = h;
    if (l != h)
        v = (v - l) / (h - l);
    else
        v = 0;
    *pR = (v < 4 / 5.0) * (5 / 4.0 * v) + (v >= 4 / 5.0);
    *pG = 0.7812 * v;
    *pB = 0.4975 * v;
    return CO_OK;
}

static int
palura(real v, real l, real h, float *pR, float *pG, float *pB)
{
    int i;
    int j;
    int n;
    real al;
    real be;

    n = sizeof(Palura) / sizeof(*Palura);
    if (v < l)
        v = l;
    if (v > h)
        v = h;
    if (l != h)
        v = (n - 1) * (v - l) / (h - l);
    else
        v = 0;
    i = (int) v;
    if (i < 0)
        i = 0;
    j = i + 1;
    if (j > n - 1)
        j = n - 1;
    al = v - i;
    be = j - v;
    *pR = al * Palura[i][0] + be * Palura[j][0];
    *pG = al * Palura[i][1] + be * Palura[j][1];
    *pB = al * Palura[i][2] + be * Palura[j][2];
    return CO_OK;
}

static int
white(real v, real l, real h, float *pR, float *pG, float *pB)
{
    USED(v);
    USED(l);
    USED(h);
    *pR = 1;
    *pG = 1;
    *pB = 1;
    return CO_OK;
}

static int
spring(real v, real l, real h, float *pR, float *pG, float *pB)
{
    if (v < l)
        v = l;
    if (v > h)
        v = h;
    if (l != h)
        v = (v - l) / (h - l);
    else
        v = 0;
    *pR = 1;
    *pG = v;
    *pB = 1 - v;
    return CO_OK;
}
